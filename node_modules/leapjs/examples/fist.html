<html>
  <head>
    <title>Dumper - Leap</title>
    <script src="../leap-0.6.4.js"></script>
    <script>
    const minValue = 0.5;

    var controller = Leap.loop(function(frame){
       if(frame.hands.length>0)
       {
          var hand = frame.hands[0];
          var isFist = checkFist(hand);
       }
    });

    function getExtendedFingers(hand){
       var f = 0;
       for(var i=0;i<hand.fingers.length;i++){
          if(hand.fingers[i].extended){
             f++;
          }
       }
       return f;
    }

    function checkFist(hand){
       var sum = 0;
       for(var i=0;i<hand.fingers.length;i++){
          var finger = hand.fingers[i];
          var meta = finger.bones[0].direction();
          var proxi = finger.bones[1].direction();
          var inter = finger.bones[2].direction();
          var dMetaProxi = Leap.vec3.dot(meta,proxi);
          var dProxiInter = Leap.vec3.dot(proxi,inter);
          sum += dMetaProxi;
          sum += dProxiInter
       }
       sum = sum/10;

       if(sum<=minValue && getExtendedFingers(hand)==0){
           console.log('fist');
           return true;
       }else{
            console.log('not a fist');
           return false;
       }
    }
    </script>
  </head>
  <body>
  <button onclick="controller.disconnect();">Disconnect</button>
  <button onclick="controller.connect();">Connect</button>
  <pre>
    <div id="out"></div>
  </pre>
  </body>
</html>
